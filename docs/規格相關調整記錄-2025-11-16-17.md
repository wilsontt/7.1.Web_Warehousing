# 規格相關調整記錄 (2025/11/16 - 2025/11/17)

## 概述
本文檔記錄過去2天中，除了bug修復外，與設計規範相關的功能調整與實作。

---

## 1. 分頁資訊顯示模式 (infoMode) ✅ 規格要求

### 規格依據
- **設計規範 v2.0** 第197-200行：
  - `full`：`X - Y 筆，共 Z 筆`
  - `compact`：`X–Y/Z`（並以 tooltip 顯示完整）
  - `auto`：以寬度自動在 full/compact 間切換

### 實作內容
- **檔案**：`components/data/DataTable.tsx`
- **新增 prop**：`infoMode?: "full" | "compact" | "auto"`
- **功能**：
  - `full`：完整顯示「X - Y 筆，共 Z 筆」
  - `compact`：精簡顯示「X–Y/Z」，hover 時 tooltip 顯示完整資訊
  - `auto`：使用 `ResizeObserver` 動態監測容器寬度，自動切換 full/compact
- **應用場景**：
  - 大分類列表（B1欄）因寬度較小，使用 `infoMode="compact"`（符合規格第154行要求）

### 相關檔案
- `components/data/DataTable.tsx` (新增 infoMode 邏輯)
- `components/codes/MajorCategoryList.tsx` (使用 `infoMode="compact"`)
- `lib/config/dataTableConfig.ts` (相關樣式配置)

---

## 2. 分頁按鈕圖示化 ✅ 規格要求

### 規格依據
- **設計規範 v2.0** 第196行：
  > 分頁按鈕：圓形、具 hover/active/disabled 狀態；當前頁以主色底＋白字顯示。

### 實作內容
- **檔案**：`components/data/DataTable.tsx`
- **變更**：
  - 將文字按鈕（「第一頁」、「上一頁」、「下一頁」、「最後一頁」）改為圖示按鈕
  - 使用 SVG 圖示（`<<`, `<`, `>`, `>>`）
  - 新增「跳至第幾頁」輸入框
  - 新增「第 X / Y 頁」Badge 顯示當前頁數
  - 按鈕樣式：圓形、hover 效果、disabled 狀態、當前頁主色底＋白字

### 相關檔案
- `components/data/DataTable.tsx` (分頁控制區塊)
- `lib/config/dataTableConfig.ts` (paginationButton 樣式)

---

## 3. 列表互動效果 (Hover/Selected) ✅ 規格要求

### 規格依據
- **設計規範 v2.0** 第194-195行：
  > - Hover：列需以主色淡化背景與 `ring-2` 呈現，深/淺色各自對應色階。
  > - Selected：使用較高對比底色（淺色 `primary-100`、深色 `primary-900/40`），可與 hover 共存。

### 實作內容
- **檔案**：`lib/config/dataTableConfig.ts`
- **變更**：
  - **Hover 效果**：
    - `tr`: `hover:bg-primary-100 dark:hover:bg-primary-900/30 hover:ring-2 hover:ring-primary-500 hover:shadow-sm`
    - 整列變色（移除單格 hover，改為整列）
  - **Selected 效果**：
    - `trSelected`: `bg-primary-100 dark:bg-primary-900/50 ring-2 ring-primary-500`
  - **Zebra-striping**：
    - `trOdd`: `bg-gray-100 dark:bg-gray-800/60`（增強對比）
    - `trEven`: `bg-white dark:bg-gray-900`
  - **項次欄位**：hover 時左側顯示藍色邊框（視覺回饋）

### 相關檔案
- `lib/config/dataTableConfig.ts` (TABLE_CLASSES)
- `components/codes/MajorCategoryList.tsx` (移除單格 hover)
- `components/codes/MidCategoryList.tsx` (移除單格 hover)
- `components/codes/SubCategoryList.tsx` (移除單格 hover)

---

## 4. 深色/淺色模式一致性 ✅ 規格要求

### 規格依據
- **設計規範 v2.0** 第185-191行：
  > - 適用範圍：A 區 TopNavigation、主選單與子選單面板、B 區主要內容區、所有表格/卡片、Dialog、Dropdown、Tooltip、分頁列。
  > - 全域底色與字色：
  >   - 淺色：`body bg-white text-gray-900`
  >   - 深色：`body bg-gray-900 text-gray-100`
  > - 邊框與分隔：淺色使用 `gray-200`，深色使用 `gray-700`

### 實作內容
- **全域背景**：
  - `app/globals.css`：明確設定 `body` 背景色與文字顏色
- **列表容器**：
  - `MajorCategoryList`、`MidCategoryList`、`SubCategoryList`：加上 `bg-white dark:bg-gray-900`
  - `ThreeColumnLayout`：三個欄位都加上 `bg-white dark:bg-gray-900`
- **DataTable**：
  - wrapper、tbody、分頁列：完整支援深色模式
- **Dashboard Widgets**：
  - 所有 Widget 元件加上 `dark:bg-gray-800`、`dark:border-gray-700`

### 相關檔案
- `app/globals.css` (全域樣式)
- `components/codes/MajorCategoryList.tsx`
- `components/codes/MidCategoryList.tsx`
- `components/codes/SubCategoryList.tsx`
- `components/layouts/ThreeColumnLayout.tsx`
- `components/data/DataTable.tsx`
- `components/dashboard/*Widget.tsx`

---

## 5. 工具列佈局 (Breadcrumbs + Toolbar) ✅ 規格要求

### 規格依據
- **設計規範 v2.0** 第36行：
  > - B2-1 (頂部工具列):
  >   - 左側：以麵包屑 (Breadcrumbs) 模式顯示當前頁面的導覽路徑
  >   - 右側 (Toolbar): 包含 新增、修改、查詢、列印、確認、取消 及 停用/封存 按鈕。

### 實作內容
- **檔案**：`app/(modules)/basic-operations/code/basic/page.tsx`
- **變更**：
  - 頂部工具列改為左右排列（`flex items-center justify-between`）
  - 左側：`Breadcrumbs` 元件，顯示「首頁 > 基本作業 > 基本代碼維護」
  - 右側：`CodesToolbar` 元件，靠右對齊（`ml-auto`）
  - 調整 padding：`px-4 py-2`（減少垂直空間）

### 相關檔案
- `app/(modules)/basic-operations/code/basic/page.tsx` (工具列佈局)
- `components/navigation/Breadcrumbs.tsx` (字體顏色調整)

---

## 6. 項次欄位 (Sequence Number Column) ✅ 已納入規格

### 規格依據
- **原無明確規格要求**，已於 2025/11/17 納入設計規範 v2.0 第194-197行

### 實作內容
- **檔案**：`components/data/DataTable.tsx`
- **功能**：
  - 在表格最左側新增「項次」欄位
  - 顯示 1-based 的全域索引（考慮分頁）
  - 寬度固定 `w-16` (64px)
  - hover 時左側顯示藍色邊框（視覺回饋）

### 相關檔案
- `components/data/DataTable.tsx` (項次欄位實作)
- `standards/2.文件倉儲管理系統 Warehouse Management System 設計規範v2.0.md` (已更新)

---

## 7. 分頁資訊文字縮短 ✅ 規格要求

### 規格依據
- **設計規範 v2.0** 第197-200行（分頁資訊模式）

### 實作內容
- **檔案**：`components/data/DataTable.tsx`
- **變更**：
  - 將「顯示第 X 到 Y 筆，共 Z 筆」縮短為「X - Y 筆，共 Z 筆」
  - 符合規格 `full` 模式的格式要求

### 相關檔案
- `components/data/DataTable.tsx` (分頁資訊顯示)

---

## 總結

### 規格符合度檢查

| 調整項目 | 規格要求 | 實作狀態 | 備註 |
|---------|---------|---------|------|
| 分頁資訊模式 (infoMode) | ✅ 第197-200行 | ✅ 已完成 | full/compact/auto 三種模式 |
| 分頁按鈕圖示化 | ✅ 第196行 | ✅ 已完成 | 圓形、hover/active/disabled |
| Hover/Selected 效果 | ✅ 第194-195行 | ✅ 已完成 | 整列變色、ring-2、可共存 |
| 深色/淺色模式一致性 | ✅ 第185-191行 | ✅ 已完成 | 全域背景、列表、表格 |
| Breadcrumbs 左側顯示 | ✅ 第36行 | ✅ 已完成 | 工具列左側 |
| Toolbar 右側對齊 | ✅ 第36行 | ✅ 已完成 | 工具列右側 |
| 分頁資訊文字格式 | ✅ 第197行 | ✅ 已完成 | 「X - Y 筆，共 Z 筆」 |
| 項次欄位 | ✅ 已納入規格 | ✅ 已完成 | 2025/11/17 納入設計規範 |

### 已完成的更新動作

1. **✅ 更新設計規範文件**（2025/11/17）：
   - ✅ 已將「項次欄位」納入設計規範 v2.0 第194-197行
   - ✅ 已補充分頁按鈕的詳細說明（圖示化、跳至頁碼輸入框、Badge 顯示）
   - ✅ 已更新分頁資訊模式的說明（加入 ResizeObserver 技術細節）
   - ✅ 已更新 Hover/Selected 效果的說明（整列變色、深色模式色階調整）

2. **待完成文件化**：
   - ⏳ 更新 `DESIGN_GUIDELINES.md`，記錄 infoMode 的使用場景
   - ⏳ 更新 `COMPONENT_USAGE.md`，說明 DataTable 的新功能（項次欄位、分頁按鈕圖示化等）

3. **待完成測試**：
   - ⏳ 驗證 infoMode="auto" 在不同螢幕寬度下的表現
   - ⏳ 驗證深色/淺色模式切換的完整性
   - ⏳ 驗證項次欄位的全域索引計算正確性（跨分頁）

---

**文件建立日期**：2025/11/17  
**最後更新**：2025/11/17 15:30

## 更新記錄

- **2025/11/17 15:30**：
  - ✅ 已更新 `standards/2.文件倉儲管理系統 Warehouse Management System 設計規範v2.0.md`
  - ✅ 將「項次欄位」納入設計規範
  - ✅ 補充分頁按鈕的詳細說明（圖示化、跳至頁碼、Badge）
  - ✅ 更新分頁資訊模式的技術細節（ResizeObserver）
  - ✅ 更新 Hover/Selected 效果的說明（整列變色、深色模式色階）


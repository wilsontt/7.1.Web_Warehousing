# 任務清單 (Tasks): 0.1 網頁主畫面（全域 UI 框架）
**版本**: 1.0  
**狀態**: [進行中]  
**負責人**: [IT 工程師 (您)]  
**依據規格**: `規格文件 (SPEC)-文件倉儲管理系統.md` (v1.0)  
**依據計畫**: `開發計畫 (PLAN)-文件倉儲管理系統.md` (v1.0)  
**依據憲章**: v2.1.0

## 任務總覽

本文件列出「網頁主畫面（全域 UI 框架）」模組的所有開發任務，每個任務都對應到規格文件中的驗收條件，並可追溯至開發計畫的工作項目。

---

## Phase 1: UI 框架與導覽

### T1.1 實作 A/B Layout 框架 ✅
**對應規格**: 2.1 全域 UI 框架  
**對應計畫**: UI 框架與導覽  
**狀態**: 已完成

- [x] 建立 `components/layouts/ABLayout.tsx` 元件
- [x] 實作 A 區（頂部導覽列）：`position: sticky`，固定於頁面頂端
- [x] 實作 B 區（主要內容區）：佔據 A 區下方所有空間
- [x] 支援響應式佈局（桌面/平板）
- [x] 整合深色模式支援
- [x] 建立 `app/dashboard/layout.tsx` 使用 A/B Layout

**驗收條件**: 
- [x] 符合規格 2.1 驗收條件：A/B 區框架、sticky header、響應式佈局
- [x] 符合憲章 P8 一致的使用者體驗

---

### T1.2 建立頂部導覽列 A 區 ✅
**對應規格**: 2.1 全域 UI 框架（A 區）  
**對應計畫**: UI 框架與導覽  
**狀態**: 已完成

- [x] 左側：品牌 Logo + 「文件倉儲管理系統」文字
- [x] 中間：主選單（直向展開下拉選單）
  - [x] 建立主選單資料結構（八大作業）
  - [x] 實作直向展開下拉選單 UI
  - [x] 根據角色權限動態顯示選單項目
- [x] 右側：語系選擇 + 使用者下拉選單
  - [x] 語系選擇：正體中文 / English
  - [x] 使用者選單：顯示帳號、IP、登入時間、密碼變更、登出

**驗收條件**: 
- [x] 符合規格 2.1 驗收條件：A 區三部分佈局、主選單、語系與使用者選單
- [x] 符合憲章 P2 權限控制（RBAC）

---

### T1.3 建立主選單資料結構與權限控制 ✅
**對應規格**: 2.5 主選單與模組導覽  
**對應計畫**: UI 框架與導覽  
**狀態**: 已完成

- [x] 定義八大主選單資料結構（`types/menu.ts`）
  - [x] 基本作業 (Basic Operations)
  - [x] 例行作業 (Routine Operations)
  - [x] 庫存作業 (Inventory Operations)
  - [x] 客戶作業 (Customer Operations)
  - [x] 移儲作業 (Relocation Operations)
  - [x] 稽核作業 (Audit Operations)
  - [x] 倉儲管理作業 (Warehouse Administrative Operations)
  - [x] 系統管理作業 (System Administration Operations)
- [x] 建立子功能資料結構（對應各主選單）
- [x] 實作權限過濾邏輯（根據使用者角色顯示選單）
- [x] 建立選單導覽服務（`lib/services/menuService.ts`）

**驗收條件**: 
- [x] 符合規格 2.5 驗收條件：八大主選單、權限控制、子功能對應
- [x] 符合憲章 P2 權限控制（RBAC）

---

## Phase 2: 共用元件開發

### T2.1 實作 ResizableLayout 元件 ✅
**對應規格**: 2.1 全域 UI 框架（B 區 Master-Detail）、2.6 左側邊欄標準化計畫  
**對應計畫**: 共用元件  
**狀態**: 已完成

- [x] 建立 `components/layouts/ResizableLayout.tsx` 元件
- [x] 實作 B1 左側列表區（預設寬度 25%，min 18%，max 30%）
- [x] 實作 B2 右側詳細區
- [x] 實作拖曳調整寬度功能（拖曳手把）
- [x] 支援響應式佈局（平板模式）
- [x] 整合深色模式支援

**驗收條件**: 
- [x] 符合規格 2.1 驗收條件：Master-Detail 佈局、可拖曳調整
- [x] 符合規格 2.6 驗收條件：預設 22%，min 18%，max 35%（註：規格文件提到 25%，開發計畫提到 22%，以規格文件為準）
- [x] 符合憲章 P8 一致的使用者體驗

---

### T2.2 實作 DataTable 元件 ✅
**對應規格**: 2.2 共用元件與資料表格行為  
**對應計畫**: 共用元件  
**狀態**: 已完成

- [x] 建立 `components/data/DataTable.tsx` 元件
- [x] 實作分頁功能（預設每頁 20 筆，可選 5/10/20/50/100 筆）
- [x] 實作排序功能（表頭點擊排序）
- [x] 實作搜尋/篩選功能（搜尋框統一寬度 `w-40`）
- [x] 實作 Sticky Header（表頭固定）
- [x] 實作隔行變色（Zebra-striping）
- [x] 實作選取高亮（Highlight）
- [x] 設定表格樣式：
  - [x] 表頭行高：`h-10 px-3`
  - [x] 內容行高：`py-2 px-3`
  - [x] 單元格完整邊框
  - [x] 內容不自動折行（`whitespace-nowrap`）
  - [x] 容器 `overflow-auto`，必要時顯示水平捲軸
- [x] 採用 Tailwind UI 樣式

**驗收條件**: 
- [x] 符合規格 2.2 驗收條件：DataTable 所有功能與樣式要求
- [x] 符合憲章 P8 一致的使用者體驗

---

### T2.3 建立 DataTableConfig 常數檔案 ✅
**對應規格**: 2.6 左側邊欄標準化計畫  
**對應計畫**: 共用元件、文件與標準  
**狀態**: 已完成

- [x] 建立 `lib/config/dataTableConfig.ts`
- [x] 定義統一顏色配置
- [x] 定義統一間距配置
- [x] 定義統一字體配置
- [x] 定義分頁選項常數
- [x] 定義表格樣式類別常數

**驗收條件**: 
- [x] 符合規格 2.6 驗收條件：統一配置檔案
- [x] 符合憲章 P1 簡潔一致的設計

---

### T2.4 實作 Breadcrumbs 元件 ✅
**對應規格**: 2.2 共用元件與資料表格行為  
**對應計畫**: 共用元件  
**狀態**: 已完成

- [x] 建立 `components/navigation/Breadcrumbs.tsx` 元件
- [x] 採用 Tailwind UI 元件樣式
- [x] 顯示完整導覽路徑（例：基本作業＞客戶資料維護＞客戶基本資料維護）
- [x] 支援點擊導覽（可選）
- [x] 整合深色模式支援

**驗收條件**: 
- [x] 符合規格 2.2 驗收條件：Breadcrumbs 顯示完整路徑
- [x] 符合憲章 P8 一致的使用者體驗

---

### T2.5 實作 Toolbar 元件 ✅
**對應規格**: 2.2 共用元件與資料表格行為  
**對應計畫**: 共用元件  
**狀態**: 已完成

- [x] 建立 `components/toolbar/Toolbar.tsx` 元件
- [x] 實作標準按鈕：新增、修改、查詢、列印、確認、取消、停用/封存
- [x] 實作按鈕狀態管理（動態啟用/禁用）
- [x] 實作按鈕圖示與快捷鍵（可選）
- [x] 定義按鈕行為標準：
  - [x] 查詢 → 切換搜尋/篩選面板
  - [x] 新增 → 清空表單進入新增模式
  - [x] 修改 → 切換為編輯模式
  - [x] 停用 → 對資料進行非刪除的停用標記
  - [x] 刪除 → 只允許未被引用資料
  - [x] 複製 → 以當前資料為模板建立新表單
- [x] 整合深色模式支援

**驗收條件**: 
- [x] 符合規格 2.2 驗收條件：Toolbar 按鈕行為標準化
- [x] 符合憲章 P8 一致的使用者體驗

---

### T2.6 實作狀態列元件 ✅
**對應規格**: 2.2 共用元件與資料表格行為  
**對應計畫**: 共用元件  
**狀態**: 已完成

- [x] 建立 `components/status/StatusBar.tsx` 元件
- [x] 實作左右兩邊顯示：
  - [x] 左側：新增人員：[姓名] YYYY/MM/DD HH:MM:SS
  - [x] 右側：上次修改：[姓名] YYYY/MM/DD HH:MM:SS
- [x] 支援深色模式
- [x] 整合至 B2-2 資料內容區底部

**驗收條件**: 
- [x] 符合規格 2.2 驗收條件：狀態列格式與顯示位置
- [x] 符合憲章 P8 一致的使用者體驗

---

## Phase 3: Dashboard 實作

### T3.1 建立 Dashboard 頁面基礎結構 ✅
**對應規格**: 2.4 Dashboard  
**對應計畫**: 登入與 Dashboard 範例  
**狀態**: 已完成

- [x] 建立 `app/dashboard/page.tsx` 路由
- [x] 整合 A/B Layout
- [x] 建立 Dashboard 容器佈局
- [x] 實作響應式網格佈局（上半部/下半部）

**驗收條件**: 
- [x] 符合規格 2.4 驗收條件：Dashboard 基礎結構
- [x] 符合憲章 P8 一致的使用者體驗

---

### T3.2 實作 Dashboard 上半部 Widgets ✅
**對應規格**: 2.4 Dashboard  
**對應計畫**: 登入與 Dashboard 範例  
**狀態**: 已完成

- [x] 今日任務總覽 Widget
  - [x] 未完成單據數
  - [x] 待出貨數
  - [x] 待稽核數
- [x] 倉庫即時庫存概況 Widget
  - [x] 總箱數
  - [x] 使用率
  - [x] 異常數
- [x] 最新通知 Widget
  - [x] 公告
  - [x] 異常提醒
  - [x] 系統更新

**驗收條件**: 
- [x] 符合規格 2.4 驗收條件：上半部顯示內容
- [x] 符合憲章 P9 效能要求（2 秒內載入）

---

### T3.3 實作 Dashboard 下半部 Widgets ✅
**對應規格**: 2.4 Dashboard  
**對應計畫**: 登入與 Dashboard 範例  
**狀態**: 已完成

- [x] 倉庫資訊 Widget（依角色顯示）
  - [x] 一般使用者：顯示所屬倉庫
  - [x] 管理者：顯示全部倉庫
- [x] 各倉庫箱子容量/使用量/借出量 Widget
- [x] 今日工作狀態 Widget
- [x] 車輛派送即時狀況 Widget
- [x] 逾時未銷毀數量 Top 10 Widget
- [x] 存倉數量 (箱/件) Top 10 Widget
- [x] 長條圖趨勢 Widget（指定條件篩選）

**驗收條件**: 
- [x] 符合規格 2.4 驗收條件：下半部顯示內容
- [x] 符合憲章 P9 效能要求（2 秒內載入）

---

### T3.4 建立 Dashboard API 服務（Mock） ✅
**對應規格**: 2.4 Dashboard  
**對應計畫**: 登入與 Dashboard 範例  
**狀態**: 已完成

- [x] 建立 `lib/api/dashboard.ts` API 服務
- [x] 建立 Mock 資料（`lib/mocks/dashboardMock.ts`）
- [x] 實作 Dashboard 資料取得函數
- [x] 整合至 Dashboard 頁面

**驗收條件**: 
- [x] 符合規格 2.4 驗收條件：Dashboard 資料載入
- [x] 符合憲章 P9 效能要求（2 秒內載入）

---

## Phase 4: 登入流程整合

### T4.1 整合登入後導向 Dashboard ✅
**對應規格**: 2.3 登入與身分驗證  
**對應計畫**: 登入與 Dashboard 範例  
**狀態**: 已完成

- [x] 修改 `components/LoginForm.tsx` 登入成功後導向 `/dashboard`
- [x] 確保登入狀態正確儲存（已由 API 回應攔截器自動儲存）
- [x] 確保 Dashboard 需要登入才能存取（路由保護，已整合 AuthGuard）

**驗收條件**: 
- [x] 符合規格 2.3 驗收條件：登入後導向 Dashboard
- [x] 符合憲章 P2 安全要求

---

### T4.2 實作路由保護（Authentication Guard） ✅
**對應規格**: 2.3 登入與身分驗證  
**對應計畫**: 登入與 Dashboard 範例  
**狀態**: 已完成

- [x] 建立 `components/auth/AuthGuard.tsx` 元件
- [x] 實作登入狀態檢查
- [x] 未登入時導向 `/login`（並儲存返回 URL）
- [x] 整合至 Dashboard 與其他需要保護的路由（Dashboard layout、Login layout）

**驗收條件**: 
- [x] 符合規格 2.3 驗收條件：路由保護
- [x] 符合憲章 P2 安全要求

---

## Phase 5: 文件與標準

### T5.1 撰寫 DESIGN_GUIDELINES.md ✅
**對應規格**: 2.6 左側邊欄標準化計畫  
**對應計畫**: 文件與標準  
**狀態**: 已完成

- [x] 建立 `docs/DESIGN_GUIDELINES.md`
- [x] 記錄左側邊欄標準
- [x] 記錄 ResizableLayout 使用方式
- [x] 記錄 DataTable 使用方式
- [x] 記錄 Toolbar 使用方式
- [x] 記錄狀態列使用方式
- [x] 記錄 Breadcrumbs 使用方式
- [x] 提供程式碼範例與最佳實踐

**驗收條件**: 
- [x] 符合規格 2.6 驗收條件：DESIGN_GUIDELINES.md 文件
- [x] 符合憲章 P1 簡潔一致的設計

---

### T5.2 建立標準模板與組件使用指南 ✅
**對應規格**: 2.6 左側邊欄標準化計畫  
**對應計畫**: 文件與標準  
**狀態**: 已完成

- [x] 建立範例頁面模板（`templates/MasterDetailPageTemplate.tsx`）
- [x] 建立組件使用指南（`docs/COMPONENT_USAGE.md`）
- [x] 提供完整程式碼範例
- [x] 提供最佳實踐建議

**驗收條件**: 
- [x] 符合規格 2.6 驗收條件：標準模板與使用指南
- [x] 符合憲章 P1 簡潔一致的設計

---

## Phase 6: 測試與品質保證

### T6.1 單元測試 ✅
**對應規格**: 5. 測試與驗收  
**對應計畫**: 測試與品質保證  
**狀態**: 已完成

- [x] 測試 A/B Layout 元件
- [x] 測試 ResizableLayout 元件
- [x] 測試 DataTable 元件（分頁、排序、搜尋）
- [x] 測試 Toolbar 元件
- [x] 測試 Breadcrumbs 元件
- [x] 測試狀態列元件
- [x] 測試主選單權限過濾邏輯

**驗收條件**: 
- [x] 符合規格 5. 測試與驗收：單元測試覆蓋
- [x] 符合憲章 P7 測試要求

---

### T6.2 整合測試 ✅
**對應規格**: 5. 測試與驗收  
**對應計畫**: 測試與品質保證  
**狀態**: 已完成

- [x] 測試登入流程 → Dashboard 載入
- [x] 測試主選單導覽與頁面狀態保持
- [x] 測試 Dashboard 資料載入時間（< 2 秒）
- [x] 測試權限控制（不同角色看到不同選單）

**驗收條件**: 
- [x] 符合規格 5. 測試與驗收：整合測試覆蓋
- [x] 符合憲章 P7 測試要求、P9 效能要求

---

### T6.3 E2E 測試 ✅
**對應規格**: 5. 測試與驗收  
**對應計畫**: 測試與品質保證  
**狀態**: 已完成

- [x] 測試從登入到 Dashboard 完整流程
- [x] 測試主選單點擊與頁面切換
- [x] 測試 Toolbar 按鈕互動
- [x] 測試狀態列顯示

**驗收條件**: 
- [x] 符合規格 5. 測試與驗收：E2E 測試覆蓋
- [x] 符合憲章 P7 測試要求

---

### T6.4 非功能測試
**對應規格**: 3. 非功能性需求、5. 測試與驗收  
**對應計畫**: 測試與品質保證  
**狀態**: 已完成

- [x] Lighthouse 測試（目標 90+）
- [x] 無障礙測試（WCAG AA）
- [x] 安全測試（XSS/CSRF/Session Timeout）
- [x] 效能 Profiling（Dashboard 載入時間）

**驗收條件**: 
- [x] 符合規格 3. 非功能性需求：效能、安全、可用性
- [x] 符合規格 5. 測試與驗收：非功能測試
- [x] 符合憲章 P2 安全要求、P9 效能要求

**完成日期**: 2025/11/15

**測試檔案**:
- `__tests__/non-functional/performance.test.ts` - 效能測試
- `__tests__/non-functional/accessibility.test.tsx` - 無障礙測試
- `__tests__/non-functional/security.test.ts` - 安全測試
- `__tests__/non-functional/lighthouse.test.ts` - Lighthouse 測試指南
- `scripts/run-lighthouse.js` - Lighthouse 自動化腳本
- `docs/NON_FUNCTIONAL_TESTING.md` - 非功能測試指南

---

## Phase 7: 憲章遵循檢查

### T7.1 執行憲章遵循檢查
**對應規格**: 6. 憲章遵循檢查  
**對應計畫**: 憲章遵循檢查  
**狀態**: 已完成

- [x] 檢查 P1：簡潔一致的 UI 與模組化架構
- [x] 檢查 P2：安全措施（登入、RBAC、稽核、加密、2FA、自動登出）
- [x] 檢查 P3：可測試的驗收條件
- [x] 檢查 P4：可分批交付
- [x] 檢查 P5：正體中文文案
- [x] 檢查 P6：程式碼品質標準
- [x] 檢查 P7：測試類型與驗收標準
- [x] 檢查 P8：統一 UI/UX 元件與 Explicit Save 原則
- [x] 檢查 P9：效能門檻
- [x] 檢查 P10-P13：DDD、模組化單體、資料治理、可觀測性
- [x] 檢查 H1-H3：修訂程序、版本管理、合規要求
- [x] 建立 `0.1.網頁主畫面/憲章遵循檢查.md` 文件

**驗收條件**: 
- [x] 符合規格 6. 憲章遵循檢查：所有原則檢查完成
- [x] 符合憲章 H3 文件要求

**完成日期**: 2025/11/15

**檢查結果**: ✅ 所有憲章原則檢查完成，狀態：全部符合

**檢查文件**: `0.1.網頁主畫面/憲章遵循檢查.md`

---

## 任務狀態總覽

| Phase | 任務數 | 已完成 | 進行中 | 待開始 |
|-------|--------|--------|--------|--------|
| Phase 1: UI 框架與導覽 | 3 | 3 | 0 | 0 |
| Phase 2: 共用元件開發 | 6 | 6 | 0 | 0 |
| Phase 3: Dashboard 實作 | 4 | 4 | 0 | 0 |
| Phase 4: 登入流程整合 | 2 | 2 | 0 | 0 |
| Phase 5: 文件與標準 | 2 | 2 | 0 | 0 |
| Phase 6: 測試與品質保證 | 4 | 4 | 0 | 0 |
| Phase 7: 憲章遵循檢查 | 1 | 1 | 0 | 0 |
| **總計** | **23** | **23** | **0** | **0** |

---

## 備註

- 所有任務都需對應到規格文件中的驗收條件
- 所有任務都需符合專案憲章的要求
- 任務執行順序可根據實際情況調整，但建議按照 Phase 順序進行
- 每個任務完成後需更新狀態並標記完成日期


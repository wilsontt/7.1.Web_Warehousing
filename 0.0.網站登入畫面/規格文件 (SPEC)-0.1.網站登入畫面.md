「# 規格文件 (SPEC): 0.1 網站登入畫面
**版本**: 1.0  
**狀態**: [草稿]  
**負責人**: [IT 工程師 (您)]  
**依據憲章**: v2.1.0

## 1. 模組概述 (Overview)
本模組定義「文件倉儲管理系統」的 Web 版登入頁面。登入頁面承接整體設計規範 (`standards/2.文件倉儲管理系統 Warehouse Management System 設計規範v2.0.md`) 的視覺與互動標準，提供帳號驗證、錯誤提示、帳號鎖定及進階驗證流程。登入成功後導向系統首頁 Dashboard。

## 2. 功能清單與使用者故事 (Features & User Stories)

### 2.1 UI 與佈局
**使用者故事**  
- **身為** 系統使用者  
- **我想要** 在統一風格的登入頁面輸入帳號密碼  
- **以便** 快速且安心地進入系統

**驗收條件** – [憲章 P3, P5, P8]  
- [ ] 介面整體風格遵循 `standards/2.文件倉儲管理系統 Warehouse Management System 設計規範v2.0.md`：淺色底、淡淺水藍色線條、圓角按鈕、支援深色模式切換 (手動 / 根據系統偏好)。  
- [ ] 登入表單位於頁面中央，保持對桌面與平板 (iPad) 友善的響應式設計。  
- [ ] 提供系統 Logo 與「文件倉儲管理系統」標題。  
- [ ] 所有文字與錯誤訊息使用正體中文，並符合語系切換策略 (預設 zh-TW，可顯示語系選單)。  
- [ ] 登入按鈕為主要 (Primary) 按鈕；取消/重設按鈕 (若提供) 為次要樣式。  
- [ ] 深色模式切換需具備平滑動畫，並記錄使用者偏好。

### 2.2 帳號與密碼輸入
**使用者故事**  
- **身為** 系統使用者  
- **我想要** 安全地輸入並檢視我的登入憑證  
- **以便** 成功登入系統

**驗收條件** – [憲章 P2, P3]  
- [ ] 必須提供 `帳號`、`密碼` 兩個欄位，均為必填。  
- [ ] 密碼欄輸入時需遮蔽 (● 或 *)，並提供顯示/隱藏切換按鈕。  
- [ ] 前端驗證：若欄位為空，需顯示即時錯誤訊息並禁用登入按鈕。  
- [ ] 送出登入請求時，需顯示 Loading 狀態，避免重複提交。  
- [ ] 登入成功後導向 Dashboard，並需初始化使用者會話與權限資訊。

### 2.3 錯誤處理與帳號鎖定
**使用者故事**  
- **身為** 系統使用者  
- **我想要** 理解登入失敗原因並保護帳號  
- **以便** 重新嘗試或聯繫管理員

**驗收條件** – [憲章 P2, P3]  
- [ ] 帳號或密碼錯誤時，顯示固定訊息：「您輸入的帳號或密碼不正確，請重新輸入。」並標示目前錯誤次數。  
- [ ] 系統需記錄登入錯誤次數；同一帳號連續錯誤達 6 次即鎖定帳號，提示：「您已連續輸入錯誤達 6 次，帳號已被鎖定。請與管理人員聯繫。」  
- [ ] 帳號鎖定資訊需寫入稽核日誌 (帳號、IP、時間)。  
- [ ] 錯誤訊息不得透露帳號是否存在或其他敏感資訊。  
- [ ] 鎖定狀態需由後端控制，前端僅顯示 API 回覆結果。

### 2.4 二階段驗證與安全控制
**使用者故事**  
- **身為** 系統管理員  
- **我想要** 提供第二層驗證機制  
- **以便** 提升登入安全性

**驗收條件** – [憲章 P2]  
- [ ] 登入成功驗證帳號密碼後，需支援選用的二階段驗證 (簡訊或 Email 驗證碼)。  
- [ ] 使用者可於 2FA 畫面選擇傳送方式，系統發送 6 位數驗證碼 (有效期限 5 分鐘)。  
- [ ] 驗證碼輸入錯誤 5 次需重新發送。  
- [ ] 2FA 成功後方可建立完整會話並導向 Dashboard。  
- [ ] 2FA 所有操作需記錄稽核日誌。

### 2.5 自動登出與未儲存資料提示
**使用者故事**  
- **身為** 系統使用者  
- **我想要** 在閒置時被提醒並保護會話  
- **以便** 避免未授權存取

**驗收條件** – [憲章 P2, P8.3]  
- [ ] 登入後 30 分鐘無操作自動登出；登出前 1 分鐘彈窗提示是否延長會話。  
- [ ] 自動登出時若使用者尚未儲存資料，需提示「未儲存資料可能遺失」。  
- [ ] 登出後返回登入頁並清除敏感資訊 (例如瀏覽器記憶的密碼欄位需遮蔽)。

## 3. 非功能性需求 (Non-Functional Requirements)
- **效能** [憲章 P9]：  
  - 登入 API 回應時間 ≤ 1 秒 (正常負載)。  
  - 2FA 驗證碼送達時間 ≤ 30 秒。  
- **安全** [憲章 P2]：  
  - 必須透過 HTTPS 傳輸，並採用中央 IdP (OIDC/OAuth2)。  
  - 密碼不得於前端儲存；打錯密碼仍需回傳通用錯誤訊息。  
  - 所有登入嘗試、2FA 操作需產生稽核日誌。  
- **易用性** [憲章 P8]：  
  - 行動裝置上需維持可點擊的控件尺寸 (≥ 44x44 px)。  
  - 支援鍵盤操作 (Enter 提交、Tab 導覽)。  
- **可觀測性** [憲章 P13]：  
  - 前端需紀錄登入成功/失敗事件，提供追蹤 ID 以利後端追蹤。  
  - 後端需提供健康檢查端點確認認證服務可用性。

## 4. 模組依賴性 (Dependencies)
- 依賴中央身份驗證服務 (IdP) 與 RBAC 權限系統。  
- 需與 `Dashboard` 模組串接登入後導向流程。  
- 稽核紀錄需與「系統操作紀錄」模組整合。  
- 2FA 簡訊 / Email 發送服務需配置可用頻道。

## 5. 憲章遵循檢查 (Constitution Check)
- **P1**：介面與流程維持簡潔，避免不必要的複雜度。  
- **P2**：全面涵蓋 RBAC、2FA、稽核、HTTPS 等安全要求。  
- **P3**：所有功能具明確、可測試的驗收條件。  
- **P4**：功能可分階段交付 (基本登入 → 錯誤處理 → 2FA → 自動登出)。  
- **P5**：所有文案與訊息以正體中文呈現，可擴充語系。  
- **P7**：登入流程提供測試可驗證的條件 (API 時間、錯誤計數)。  
- **P8**：符合設計規範的 UI 與明確儲存控制。  
- **P9**：定義登入與 2FA 的效能門檻。  
- **P10–P13**：整合既有架構、資料治理與可觀測性流程。  
- **H1–H3**：首次建立版本 1.0，後續修訂須依照 Pull Request 流程。


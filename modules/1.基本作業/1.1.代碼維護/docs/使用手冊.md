# 代碼維護使用手冊

**版本**: 1.0  
**建立日期**: 2025/11/15  
**最後更新**: 2025/11/15

## 1. 功能概述

代碼維護模組提供三欄式連動介面，用於管理大分類、中分類、細分類的階層式代碼資料。所有資料異動（新增、修改、刪除）需透過明確的「儲存」動作批次提交。

## 2. 操作說明

### 2.1 介面說明

- **左側列表（B1）**：顯示大分類列表
- **中間列表（B2）**：顯示中分類列表（需先選取大分類）
- **右側列表（B3）**：顯示細分類列表（需先選取大分類與中分類）

### 2.2 新增資料

1. **新增大分類**：
   - 點選工具列的「新增大分類」按鈕
   - 在左側列表會出現空白列
   - 點選儲存格進行編輯，輸入大分類編碼（3 字元）和大分類名稱（最多 120 字元）

2. **新增中分類**：
   - 先從左側選取一個大分類
   - 點選工具列的「新增中分類」按鈕
   - 在中間列表會出現空白列，系統自動帶入大分類編碼
   - 點選儲存格進行編輯，輸入中分類編碼（3 字元）和編碼說明（最多 120 字元）

3. **新增細分類**：
   - 先從左側選取一個大分類，再從中間選取一個中分類
   - 點選工具列的「新增細分類」按鈕
   - 在右側列表會出現空白列，系統自動帶入大分類編碼和中分類編碼
   - 點選儲存格進行編輯，輸入細分類編碼（3 字元）和編碼說明（最多 120 字元）

### 2.3 修改資料

1. 點選要修改的列
2. 點選要修改的儲存格進入編輯模式
3. 修改內容後，按 Enter 或點選其他位置完成編輯
4. 修改的列會以黃色背景標示
5. 點選「儲存」按鈕儲存變更

**注意**：鍵值欄位（大分類編碼、中分類編碼、細分類編碼）建立後不可修改。

### 2.4 刪除資料

1. 選取要刪除的列
2. 點選工具列的「刪除」按鈕
3. 確認刪除對話框
4. 刪除的列會以刪除線標示
5. 點選「儲存」按鈕確認刪除

**注意**：刪除大分類或中分類時，必須先刪除所有子分類。

### 2.5 儲存變更

1. 完成所有新增、修改、刪除操作後
2. 點選工具列的「儲存」按鈕
3. 系統會進行前端驗證
4. 驗證通過後，批次提交至後端
5. 儲存成功後，系統會重新載入最新資料

### 2.6 取消變更

1. 點選工具列的「取消」按鈕
2. 確認取消對話框
3. 系統會放棄所有未儲存的變更並重新載入資料

### 2.7 查詢功能

1. 點選工具列的「查詢」按鈕
2. 在查詢對話框中輸入關鍵字（可搜尋代號、名稱、說明）
3. 可選填大分類代號作為篩選條件
4. 點選「查詢」按鈕
5. 點選查詢結果可直接跳轉至該列

### 2.8 列印功能

1. 點選工具列的「列印」按鈕
2. 系統會產生列印格式（三欄層級表格）
3. 包含列印日期、操作者、目前篩選條件
4. 使用瀏覽器列印功能進行列印

## 3. 欄位說明

### 3.1 大分類欄位

- **大分類編碼**（必填）：3 字元，只能包含英數字，建立後不可修改
- **大分類名稱**（必填）：最多 120 字元

### 3.2 中分類欄位

- **中分類編碼**（必填）：3 字元，只能包含英數字，建立後不可修改
- **編碼說明**（必填）：最多 120 字元
- **數值1**（選填）：數值
- **數值2**（選填）：數值
- **備註**（選填）：最多 240 字元

### 3.3 細分類欄位

- **細分類編碼**（必填）：3 字元，只能包含英數字，建立後不可修改
- **編碼說明**（必填）：最多 120 字元
- **備註**（選填）：最多 240 字元

## 4. 注意事項

1. **未儲存變更提示**：
   - 有未儲存變更時，切換分類或關閉頁面會顯示確認對話框
   - 請記得儲存變更，避免資料遺失

2. **禁止重複新增**：
   - 已有未儲存的新增列時，禁止重複新增

3. **層級關聯**：
   - 新增中分類前必須先選取大分類
   - 新增細分類前必須先選取大分類與中分類

4. **鍵值欄位限制**：
   - 大分類編碼、中分類編碼、細分類編碼建立後不可修改

5. **刪除限制**：
   - 刪除大分類或中分類時，必須先刪除所有子分類

## 5. 常見問題

### Q1: 為什麼無法新增中分類？
A: 請先從左側選取一個大分類。

### Q2: 為什麼無法修改編碼欄位？
A: 編碼欄位（大分類編碼、中分類編碼、細分類編碼）建立後不可修改，這是為了確保資料完整性。

### Q3: 為什麼刪除失敗？
A: 請確認該分類下沒有子分類。刪除大分類前必須先刪除所有中分類和細分類；刪除中分類前必須先刪除所有細分類。

### Q4: 如何取消所有變更？
A: 點選工具列的「取消」按鈕，系統會放棄所有未儲存的變更並重新載入資料。

## 6. 技術支援

如有任何問題，請聯繫系統管理員。

---

**文件版本**: 1.0  
**最後更新**: 2025/11/15
